var Tlop=Tlop||{};Tlop.Utils=function(){function a(a,b){return(" "+a.className+" ").indexOf(" "+b+" ")>-1}function b(a,b){var c=a.className;a&&b&&(c?"-1"!==c.indexOf(b)&&(a.className=c+" "+b):a.className=b)}function c(a,b){var c=a.className;a&&b&&c&&(c=c.replace(" "+b,""),c=c.replace(b+" ",""),c=c.replace(b,""),a.className=c)}return{hasClass:a,addClass:b,removeClass:c}}();var Tlop=Tlop||{};Tlop.Const=function(){var a={ROWS:7,COLS:15,START_ROW:3,START_COL:7,BLOCK:80},b={BODY:document.querySelector("body"),TLOP:document.getElementById("tlop")};return{GRID:a,DOM:b}}(),Tlop=Tlop||{},Tlop.Settings=function(){var a={pause:!0};return{Setting:a}}(),Tlop=Tlop||{},Tlop.Script=function(){var a={STORY:{},NPC:{}},b=function(){console.log("loading "+script+" script")};return{Story:a.STORY,NPC:a.NPC,loadScript:b}}(),Tlop=Tlop||{},Tlop.Splash=function(){var a=!1,b=function(){Tlop.Const.DOM.TLOP.innerHTML=g(),e()},c=function(){f(),Tlop.Map.render("main",[-2,-2]),Tlop.Settings.Setting.pause=!1,Tlop.Pookie.init()},d=function(b){var d,e=b.keyCode,f=document.querySelector(".splash-menu .selected"),g=document.querySelector(".home"),h=document.querySelector(".instructions");switch(e){case 40:case 83:a||(Tlop.Utils.removeClass(f,"selected"),d=f.nextElementSibling?f.nextElementSibling:f.previousElementSibling,Tlop.Utils.addClass(d,"selected"));break;case 38:case 87:a||(Tlop.Utils.removeClass(f,"selected"),d=f.previousElementSibling?f.previousElementSibling:f.nextElementSibling,Tlop.Utils.addClass(d,"selected"));break;case 13:a?(a=!1,Tlop.Utils.removeClass(h,"displayed"),Tlop.Utils.addClass(g,"displayed")):Tlop.Utils.hasClass(f,"start")?c():(a=!0,Tlop.Utils.removeClass(g,"displayed"),Tlop.Utils.addClass(h,"displayed"))}},e=function(){window.addEventListener?window.addEventListener("keydown",d,!1):window.attachEvent&&window.attachEvent("onkeydown",d)},f=function(){window.addEventListener?window.removeEventListener("keydown",d):window.attachEvent&&window.detachEvent("onkeydown",d)},g=function(){var a="";return a+='<div id="splash">',a+='  <div class="home displayed">',a+="    <h1>The Legend of Pookie</h1>",a+="    <h2>A Pug to the Past</h2>",a+='    <ul class="splash-menu">',a+="      <li class=\"start selected\">Press 'ENTER' to start</li>",a+='      <li class="howto">How to Play</li>',a+="    </ul>",a+="  </div>",a+='  <div class="instructions">',a+="    <h1>How to play</h1>",a+="    <ul>",a+="      <li>Move using the 'WASD' keys</li>",a+="      <li>K = Talk/Select</li>",a+="      <li>L = Attack</li>",a+="      <li>Enter = Pause</li>",a+="    </ul>",a+="  </div>",a+="</div>"};return{load:b,unload:c}}(),Tlop=Tlop||{},Tlop.Map=function(){var a,b,c={"@":"step","#":"road",G:"grass",P:"bush",K:"pot",O:"rock",W:"water",T:"top-edge",L:"left-edge",B:"bottom-edge",R:"right-edge",TL:"top-left-edge",BL:"bottom-left-edge",TR:"top-right-edge",BR:"bottom-right-edge"},d={main:{field:[["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","#","#","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","#","#","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","#","#","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","#","#","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"],["G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G","G"]],objects:[["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","P","K","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","O","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"],["@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@","@"]]},cave:[["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"]]},e={COL:"data-col",ROW:"data-row",CORD:"data-cords"},f=[0,0],g={},h=function(a,b){var d,e,f,g,h=b.length,i=b[0].length,j={tiles:[],name:a,size:{rows:h,columns:i}};for(d=0;h>d;d++)for(f=b[d],e=0;i>e;e++)g=f[e],j.tiles.push({col:d,row:e,classes:c[g]});return j},i=function(c,e){var f,g,i=(window.innerWidth,window.innerHeight,h(c,d[c].field)),k=h(c,d[c].objects),r=i.tiles,s=k.tiles;for(Tlop.Const.DOM.TLOP.innerHTML='<div id="field"></div><div id="map"></div>',a=document.getElementById("field"),b=document.getElementById("map"),Tlop.Const.DOM.TLOP.style.width=Tlop.Const.GRID.COLS*Tlop.Const.GRID.BLOCK+"px",Tlop.Const.DOM.TLOP.style.height=Tlop.Const.GRID.ROWS*Tlop.Const.GRID.BLOCK+"px",b.className=k.name+"-map",o(k.size.columns*Tlop.Const.GRID.BLOCK),p(k.size.rows*Tlop.Const.GRID.BLOCK),q(k.size.columns,k.size.rows),m(e[0]*Tlop.Const.GRID.BLOCK),n(e[1]*Tlop.Const.GRID.BLOCK),l(Tlop.Const.GRID.START_COL-e[1],Tlop.Const.GRID.START_ROW-e[0]),g=0;g<r.length;g++)f=j(r[g]),objectTile=j(s[g]),a.appendChild(f),b.appendChild(objectTile)},j=function(a){var b=document.createElement("DIV");return b.className="block "+a.classes,b.style.top=a.row*Tlop.Const.GRID.BLOCK+"px",b.style.left=a.col*Tlop.Const.GRID.BLOCK+"px",b.style.width=Tlop.Const.GRID.BLOCK+"px",b.style.height=Tlop.Const.GRID.BLOCK+"px",b.setAttribute(e.CORD,a.row+"-"+a.col),b.setAttribute(e.ROW,a.col),b.setAttribute(e.COL,a.row),b},k=function(){return f},l=function(a,b){f=[a,b]},m=function(c){b.style.top=c+"px",a.style.top=c+"px"},n=function(c){b.style.left=c+"px",a.style.left=c+"px"},o=function(c){b.style.width=c+"px",a.style.width=c+"px"},p=function(c){b.style.height=c+"px",a.style.height=c+"px"},q=function(a,b){g={cols:a,rows:b}},r=function(){return g};return{render:i,getCurrentCords:k,setCurrentCords:l,setMapTop:m,setMapLeft:n,getMapSize:r}}(),Tlop=Tlop||{},Tlop.Pookie=function(){var a,b={UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right"},c={COL:"data-col",ORIENTATION:"data-orientation",ROW:"data-row"},d={POT:"pot",BUSH:"bush",MONSTER:"monster"},e={NPC:"npc",STEP:"step"},f=function(){a=document.createElement("DIV"),a.id="pookie",a.style.top=Tlop.Const.GRID.START_ROW*Tlop.Const.GRID.BLOCK+"px",a.style.left=Tlop.Const.GRID.START_COL*Tlop.Const.GRID.BLOCK+"px",a.style.width=Tlop.Const.GRID.BLOCK+"px",a.style.height=Tlop.Const.GRID.BLOCK+"px",a.setAttribute(c.ORIENTATION,b.UP),g(),j()},g=function(){Tlop.Const.DOM.TLOP.appendChild(a)},h=function(d){var f=parseInt(document.getElementById("map").style.top,10),g=parseInt(document.getElementById("map").style.left,10),h=Tlop.Map.getMapSize(),i=h.cols,j=h.rows,k=(a.getAttribute(c.ORIENTATION),Tlop.Map.getCurrentCords()),l="";if(!Tlop.Settings.Setting.pause)switch(d.charCode){case 119:l=document.querySelector('#map div[data-cords="'+k[0]+"-"+(k[1]-1)+'"]'),a.setAttribute(c.ORIENTATION,b.UP),l&&l.getAttribute(c.ROW)>=0&&Tlop.Utils.hasClass(l,e.STEP)&&(Tlop.Map.setCurrentCords(k[0],k[1]-1),Tlop.Map.setMapTop(f+Tlop.Const.GRID.BLOCK));break;case 115:l=document.querySelector('#map div[data-cords="'+k[0]+"-"+(k[1]+1)+'"]'),a.setAttribute(c.ORIENTATION,b.DOWN),l&&l.getAttribute(c.ROW)<j&&Tlop.Utils.hasClass(l,e.STEP)&&(Tlop.Map.setCurrentCords(k[0],k[1]+1),Tlop.Map.setMapTop(f-Tlop.Const.GRID.BLOCK));break;case 97:l=document.querySelector('#map div[data-cords="'+(k[0]-1)+"-"+k[1]+'"]'),a.setAttribute(c.ORIENTATION,b.LEFT),l&&l.getAttribute(c.COL)>=0&&Tlop.Utils.hasClass(l,e.STEP)&&(Tlop.Map.setCurrentCords(k[0]-1,k[1]),Tlop.Map.setMapLeft(g+Tlop.Const.GRID.BLOCK));break;case 100:l=document.querySelector('#map div[data-cords="'+(k[0]+1)+"-"+k[1]+'"]'),a.setAttribute(c.ORIENTATION,b.RIGHT),l&&l.getAttribute(c.COL)<i&&Tlop.Utils.hasClass(l,e.STEP)&&(Tlop.Map.setCurrentCords(k[0]+1,k[1]),Tlop.Map.setMapLeft(g-Tlop.Const.GRID.BLOCK))}},i=function(f){var g,h,i,j=a.getAttribute(c.ORIENTATION),k=Tlop.Map.getCurrentCords(),l=f.keyCode;if(!Tlop.Settings.Setting.pause){switch(j){case b.UP:g=document.querySelector('#map div[data-cords="'+k[0]+"-"+(k[1]-1)+'"]');break;case b.DOWN:g=document.querySelector('#map div[data-cords="'+k[0]+"-"+(k[1]+1)+'"]');break;case b.LEFT:g=document.querySelector('#map div[data-cords="'+(k[0]-1)+"-"+k[1]+'"]');break;case b.RIGHT:g=document.querySelector('#map div[data-cords="'+(k[0]+1)+"-"+k[1]+'"]')}75==l?g&&Tlop.Utils.hasClass(g,e.NPC)&&(h=g.getAttribut("data-script-name"),Tlop.Script.loadScript(h)):76==l&&(g&&(Tlop.Utils.hasClass(g,d.POT)||Tlop.Utils.hasClass(g,d.BUSH))?(Tlop.Utils.addClass(g,e.STEP),setTimeout(function(){Tlop.Utils.removeClass(g,e.STEP)},6e4)):g&&Tlop.Utils.hasClass(g,d.MONSTER)&&(i=g.getAttribute("data-hp")-5))}},j=function(){window.addEventListener?(window.addEventListener("keypress",h,!1),window.addEventListener("keydown",i,!1)):window.attachEvent&&(window.attachEvent("onkeypress",h),window.attachEvent("onkeydown",i))};return{init:f}}();var Tlop=Tlop||{};Tlop.Engine=function(){var a=function(){Tlop.Splash.load()};a()}();